\documentclass{beamer}
\mode<presentation>
\usepackage{amssymb,textcomp}
%\usepackage{beamerthemesplit}
\usepackage{beamerthemeJuanLesPins}
\usepackage{verbatim}
\usepackage{algorithm2e}
\usefonttheme{serif}
\title{M\'etodos Iterativos para la Resoluci\'on Num\'erica de Sistemas de Ecuacionesl Lineales.}
\author{Jos\'e Luis Ram\'irez B.}
\date{\today}
\begin{document}
\frame{\titlepage}
%\section[Introducci\'on]{}
\frame{\tableofcontents}
\section{Introducci\'on}
\begin{frame}{Problemas de los m\'etodos directos para la resoluci\'on de (SL).}
  \begin{itemize}
   \item<1-> El m\'etodo de Gauss y sus variantes se conocen con el nombre de m\'etodos
   directos: se ejecutan un n\'umero finito de pasos y dan a lugar a una soluci\'on
   que ser\'ia exacta si no fuese por los errores de redondeo.
   \item <2->Cuando el tama\~no de la matriz $A$ es grande ($n >> 100$), la propagaci\'on del error de redondeo es tambi\'en grande, y los
  resultados obtenidos pueden diferir de los exactos.
  \end{itemize}
\end{frame}
  %%%%%%%
  \frame{
    \frametitle{Problemas de los m\'etodos directos para la resoluci\'on de (SL).}
    \begin{itemize}
      \item Muchas de las matrices que aparecen en (SL) poseen la mayor\'ia de sus elementos nulos. Estas matrices reciben el nombre de matrices dispersas o sparse.
      \begin{enumerate}
      \item<2-> Si los elementos no nulos est\'an distribuidos alrededor de la diagonal principal, son de aplicaci\'on todav\'ia los m\'etodos directos que conservan la estructura diagonal, como $LU$.
      \item<3-> Si no ocurre lo anterior, al aplicar m\'etodos directos se produce un fen\'omeno de llenado. Entonces, si no se realiza una adaptaci\'on de los m\'etodos directos los resultados no van a ser, en general, buenos.
      \end{enumerate}
    \end{itemize}
  }
  %%%%%%
  \section{M\'etodos Iterativos}
  \begin{frame}{M\'etodos Iterativo}
  \begin{itemize}
  \item<1-> Un m\'etodo iterativo que da resoluci\'on al sistema $Ax = b$ es aquel que genera, a partir de un vector inicial $x^{(0)}$, una sucesi\'on de vectores $x^{(1)},x^{(2)}, \ldots$.
  \item<2-> El m\'etodo se dir\'a que es consistente con el sistema $Ax = b$, si el l\'imite de dicha sucesi\'on, en caso de existir, es
  soluci\'on del sistema.
  \item<3-> Se dir\'a que el m\'etodo es convergente si la sucesi\'on generada por cualquier vector inicial $x^{(0)}$ es convergente a la soluci\'on del sistema.
  \item<4-> El vector $r^{(k)} = b-Ax^{(k)}$ es el vector residual obtenido en la $k$-\'esima iteraci\'on.
  \end{itemize}
  \end{frame}
  %%%%%%
  \begin{frame}{M\'etodos Iterativo}
  Si un m\'etodo es convergente es consistente, sin embargo, el rec\'iproco no es cierto.
  \uncover<2->{
  \begin{block}{Ejemplo:}
  El m\'etodo $x^{(n+1)} = 2x^{(n)} - A^{-1}b$ es consistente con el sistema $Ax = b$ pero no es convergente. En efecto:
  \end{block}}
  \end{frame}
  %%%%%%
  \begin{frame}{M\'etodos Iterativo}
  \begin{eqnarray}
  x^{(n+1)}-x & = & 2x^{(n)}-A^{-1}b-x = 2x^{(n)}-2x-A^{-1}b+x \nonumber\\
  & = & 2(x^{(n)}-x)-(A^{-1}b-x)\nonumber
  \end{eqnarray}
  y como $A^{-1}b = x$, se tiene que:
  \begin{block}{}
  $$
  x^{(n+1)}-x = 2(x^{(n)}-x)
  $$
  \end{block}
  \uncover<2->{
  Si existe \textcolor{red}{$\displaystyle\lim_{n \to \infty} x^{(n)} = x^*$}, se tiene que:
  \begin{block}{}
  $$
  x^* - x=2(x^* - x) \Rightarrow x^* - x =0 \Rightarrow x^* = x
  $$
  \end{block}
  es decir, el l\'imite es soluci\'on del sistema $Ax = b$, por lo que el m\'etodo es consistente.}
  \end{frame}
  %%%%%%
  \begin{frame}{M\'etodos Iterativo}
  Sin embargo, de $x^{(n+1)} - x = 2(x^{(n)} - x)$ se obtiene que:
  \begin{block}{}
  $$
  \|x^{(n+1)}-x\| = 2\|x^{(n)}-x\|
  $$
  \end{block}
  es decir, el vector $x^{(n+1)}$ dista el doble de lo que distaba $x^{(n)}$, por lo que el m\'etodo no puede ser convergente.
  \end{frame}  
  %%%%
  \section{Refinamiento Iterativo}
  \begin{frame}{Refinamiento Iterativo}
    \begin{itemize}
      \item Al resolver un sistema de ecuaciones $Ax = b$ utilizando un m\'etodo num\'erico
      se obtiene una aproximaci\'on $\tilde x$ de la verdadera soluci\'on del sitema.
      \item<2-> La exactitud de dicha soluci\'on depende de errores inherentes a los c\'alculos realizados.
      \item<3-> Sea $x$ la soluci\'on exacta del sistema y $\tilde x$ es la aproximaci\'on, por lo tanto cuando se sustituye $\tilde x$ en el sistema se obtiene:
      \begin{block}{}
      $$
      A\tilde x \approx b
      $$
      \end{block}
      esto significa que al realizar la resta $b - A\tilde x \neq 0$      
    \end{itemize}
  \end{frame}
  %%%%%
  \begin{frame}{Refinamiento Iterativo}
    \begin{itemize}      
      \item Definiendo a esta diferencia $r$ (residuo), as\'i $r = b - A\tilde x$.
      \item<2-> La soluci\'on deseada es
      de la forma $\tilde x + z$ tal que al sustituir en el sistema de ecuaciones se obtenga
      $$
      A(\tilde x + z) = b
      $$
      y desarrollando se obtiene
      \begin{eqnarray}
        \uncover<3->{\nonumber A(\tilde x + z) & = & b}\\
        \uncover<4->{\nonumber A\tilde x + Az & = & b}\\
        \uncover<5->{\nonumber Az & = & b - A\tilde x}\\
        \uncover<6->{\nonumber Az & = & r}
      \end{eqnarray}
      \item<7-> Una vez que obtenida $z$ se puede
      crear una mejor aproximaci√≥n $\tilde x + z$ de la soluci\'on.
    \end{itemize}
  \end{frame}
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    Al resolver el sistema Ax = b donde
    $$
    A = \left[\begin{array}{ccc}
      60 & 30 & 20\\
      30 & 20 & 15\\
      20 & 15 & 12
    \end{array}\right] \quad \text{ y } \quad b = \left[\begin{array}{c}
      110\\
      65\\
      47
    \end{array}\right]
    $$
    suponiendo que una soluci\'on aproximada es $b = \left[\begin{array}{c}
      0.9\\
      0.8\\
      1.2
    \end{array}\right]$
  \end{frame}
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    \begin{itemize}
    \item Aplicando un paso de refinamiento iterativo tomando $tol = 10^{-5}$, se tendr\'ia que:
    $$
    x^{(0)} = \left[\begin{array}{c}
      0.9\\
      0.8\\
      1.2
    \end{array}\right]
    $$
    \item<2-> Calculando el residuo $r^{(0)} = b - Ax^{(0)} = \left[\begin{array}{c}
      8\\
      4\\
      2.6
    \end{array}\right]$
    \item<3->Verificando criterio de parada $\|r^{(0)}\|_{\infty} = 8 > tol$
  \end{itemize}
  \end{frame}
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    \begin{itemize}
      \item Obteniendo $z$ resolviendo el sistema $Az = r$ se obtiene $z =\left[\begin{array}{c}
        0.1\\
        0.2\\
        -0.2
      \end{array}\right]$
      \item<2->Generando la nueva aproximaci\'on
      $$
      x^{(1)} = x^{(0)} + z = \left[\begin{array}{c}
        0.9\\
        0.8\\
        1.2
      \end{array}\right] + \left[\begin{array}{c}
        0.1\\
        0.2\\
        -0.2
      \end{array}\right] = \left[\begin{array}{c}
        1\\
        1\\
        1
      \end{array}\right]
      $$
      \item<3-> Calculando el residuo $r^{(1)} = b - Ax^{(1)} = \left[\begin{array}{c}
        -0.14210854715202\\
        0\\
        0
      \end{array}\right]\times 10^{-13}$
    \end{itemize}
  \end{frame}
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    \begin{itemize}
      \item Verificando criterio de parada $\|r^{(1)}\|_{\infty} = 0.14210854715202\times 10^{-13} < tol$
      \item<2->Seg\'un el criterio de parada la mejor aproximaci\'on es $x=\left[\begin{array}{c}
        1\\
        1\\
        1
      \end{array}\right]$
    \end{itemize}
  \end{frame}
  %%%%%%}
  \begin{frame}
    \frametitle{Refinamiento Iterativo}
    \begin{itemize}
      \item Si suponemos que la soluci\'on aproximada al sistema lineal $A x = b$ se determina usando aritm\'etica de $t$ d\'igitos, se puede demostrar que el vector residual $r$ para la aproximaci\'on $\tilde x$ tiene la propiedad
      $$
       \|r\| = 10^{-t}\|A\|\|\tilde x\|
      $$
      \item<2-> De esta ecuaci\'on aproximada, se puede obtener una estimaci\'on del n\'umero de condici\'on efectivo para la aritm\'etica de $t$ d\'igitos, sin la necesidad de invertir la matriz $A$.
    \end{itemize}
  \end{frame}
  %%%%%%
  \begin{frame}
    \frametitle{Refinamiento Iterativo}
    \begin{itemize}
      \item La aproximaci\'on del n\'umero de condici\'on $\kappa(A)$ a $t$ d\'igitos viene de considerar el sistema lineal $A z = r$.
      \item<2-> De hecho $\tilde z$, la soluci\'on aproximada de $A z = r$, satisface que      
      $$
       \tilde z \approx A^{-1}r = A^{-1}(b-A\tilde x) = A^{-1}b - A^{-1}A\tilde x = x - \tilde x
      $$
      \item<3-> as\'i que $\tilde z$ es una estimaci\'on del error cometido al aproximar la soluci\'on del sistema original.      
      \begin{eqnarray}
       \nonumber \|\tilde z\| & \approx & \|x-\tilde x\|=\|A^{-1}r\| \leq \|A^{-1}\|\|r\|\\
       \nonumber & \approx & \|A^{-1}\|\left(10^{-t}\|A\|\|\tilde x\|\right) = 10^{-t}\|\tilde x\|\kappa(A)
      \end{eqnarray}
      \item<4-> Esto proporciona una aproximaci\'on para el n\'umero de condici\'on involucrado en la soluci\'on del sistema $A x = b$ usando $t$ d\'igitos:
      $$
       \kappa(A) \approx 10^t\frac{\|\tilde z\|}{\|\tilde x\|}
      $$      
    \end{itemize}
  \end{frame}      
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    \begin{itemize}
      \item<1->El sistema lineal $A x = b$ dado por
      $$
      \left(\begin{array}{ccc}
          3.333 & 15920 & -10.333\\
          2.222 & 16.71 & 9.612\\
          1.5611 & 5.1791 & 1.6852
        \end{array}\right)\left(\begin{array}{c}
        x_1\\
        x_2\\
        x_3
        \end{array}\right)=\left(\begin{array}{c}
        15913\\
        28.544\\
        8.4254
        \end{array}\right)
      $$      
      tiene la soluci\'on exacta $x = (1, 1, 1)^t$
      \item<2-> Usando eliminaci\'on Gaussiana y aritm\'etica de redondeo de 5 d\'igitos a
      $$
      \left(\begin{array}{ccc|c}
             3.333 & 15920 & -10.333 & 15913\\
             0 & -10596 & 16.501 &-10580\\
             0 & 0 & -5.079 & -4.7
            \end{array}\right)
      $$
      
      La soluci\'on aproximada a este sistema es
      
      $$
      \tilde x^{(0)} = (1.2001; 0.99991; 0.92538)^t
      $$
      \end{itemize}
\end{frame}
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    \begin{itemize}
      \item El vector residual correspondiente a $\tilde x$ calculado con doble precisi\'on (y luego redondeado a cinco d\'igitos) es 
      \small{
      \begin{eqnarray}
       \nonumber r^{(0)} & = & b - A \tilde x^{(0)} =\\
       \nonumber   & = & \left(\begin{array}{c}
            15913\\
            28.544\\
            8.4254
            \end{array}\right) - \left(\begin{array}{ccc}
             3.333 & 15920 & -10.333\\
             2.222 & 16.71 & 9.612\\
             1.5611 & 5.1791 & 1.6852
            \end{array}\right)\left(\begin{array}{c}
            1.2001\\
            0.99991\\
            0.92538
            \end{array}\right)\\
      \nonumber & = & \left(\begin{array}{c}
            -0.0051818\\
            0.27413\\
            -0.18616
            \end{array}\right)
      \end{eqnarray}}
      
      \item<2-> as\'i que 
       $$
       \|r^{(0)}\|_{\infty} = 0.27413
       $$
      \end{itemize}
    \end{frame}
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    \begin{itemize}
      \item<1-> La estimaci\'on del n\'umero de condici\'on se obtiene resolviendo primero el sistema $A z^{(0)} = r$:      
      $$
      \left(\begin{array}{ccc}
             3.333 & 15920 & -10.333\\
             2.222 & 16.71 & 9.612\\
             1.5611 & 5.1791 & 1.6852
            \end{array}\right)\left(\begin{array}{c}
            z_1\\
            z_2\\
            z_3
            \end{array}\right)=\left(\begin{array}{c}
          -0.0051818\\
          0.27413\\
          -0.18616
            \end{array}\right)
      $$
      \item <2-> La soluci\'on $z^{(0)} = (-0.20008; 8.9989 \times 10^{-5}; 0.074607)^t$ Usando la estimaci\'on del n\'umero de condici\'on      
       $$
       \kappa(A) \approx 10^5\frac{\|\tilde z^{(0)}\|_{\infty}}{\|\tilde x^{(0)}\|_{\infty}} = \frac{10^5(0.20008)}{1.2001} = 16672
       $$
      \end{itemize}
    \end{frame}  
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    \begin{itemize}
      \item Calculado $\tilde z^{(0)}$ se puede generar la nueva aproximaci\'on $\tilde x^{(1)}$
      $$
      \tilde x^{(1)} = \tilde x^{(0)} + \tilde z^{(0)} = (1.0000; 1.0000; 0.99999)^t
      $$
      \item<2-> y el error real en esta aproximaci\'on es
      $$
      \|x - \tilde x^{(1)}\|\infty = 1.0 \times 10^{-5}
      $$
      \item<3-> calculando $r^{(1)} = b - A \tilde x^{(1)}$, y resolviendo el sistema $A z^{(1)} = r^{(1)}$, se obteniene
      $$
      \tilde z^{(1)} = (-2.7003 \times 10^{-8}; 1.2973 \times 10^{-8}; 9.9817 \times 10^{-6})^t
      $$
      \item<4-> Puesto que $\|\tilde z^{(1)}\| \leq 10^{-5}$, se concluye que
      $$
      \tilde x^{(2)}= \tilde x^{(1)} + \tilde z^{(1)} = (1.0000; 1.0000; 1.0000)^t
      $$      
      es suficientemente preciso.
    \end{itemize}
  \end{frame}
  %%%%%%
  \begin{frame}
    \frametitle{Ejemplo:}
    \begin{itemize}
      \item<1-> Se ha usado la estimaci\'on $\tilde z \approx x - \tilde x$, donde $\tilde z$ es la soluci\'on aproximada al sistema $A z = r$.
      \item<2-> A partir de este resultado, se genera la nueva aproximaci\'on $\tilde x + \tilde z$.
      \item<3-> Este proceso puede ser repetido para refinar la soluci\'on sucesivamente hasta alcanzar convergencia.
    \end{itemize}
  \end{frame}
  %%%%%  
  \begin{frame}    
    \frametitle{Algoritmo}
    \small
\begin{algorithm}[H]
 \SetKwInOut{Input}{input}
 \SetKwInOut{Output}{output}
 \caption{Algoritmo de Refinamiento Iterativo.}
 \Input{$A \in \mathbb{R}^{n \times n}$, $b \in \mathbb{R}^n$, N\'umero m\'aximo de iteraciones $N$, tolerancia $TOL$.}
 \Output{Soluci\'on aproximada $x\in\mathbb{R}^n$.}
 \BlankLine
 Resolver $Ax=b$\\
 \For{$k\leftarrow 1$ \KwTo $N$}
 {
  $r=b-Ax$\\
  Resolver $Ay=r$ (usando eliminaci\'on Gaussiana en el mismo orden que en el paso 1).\\
  Calcular $K(A) = 10^t\displaystyle\frac{\|y\|}{\|x\|}$ (solo se calcula la primera vez).\\
  $x=x+y$\\
  \If{$\|y\|<TOL$}
  {
    salida $x$\\
    parar
  }
 }
\end{algorithm}
  \end{frame}
  %%%%%%  
  \section{M\'etodos Iterativos de Punto Fijo}
  \begin{frame}{M\'etodos Iterativo}
    Un m\'etodos iterativo es estacionarios cuando la transici\'on de $x^{(k)}$ a $x^{(k+1)}$ no depende de la historia anterior:
     \begin{itemize}
      \item \textbf{M\'etodos Estacionarios:} $x^{(k+1)} = f(x^{(k)})$
      \item \textbf{M\'etodos no Estacionarios:} $x^{(k+1)} = f(x^{(k)},x^{(k-1)},x^{(k-2)},\ldots)$
     \end{itemize}
    \end{frame}
\end{document}
